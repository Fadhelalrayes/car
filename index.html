<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>إيصال/رصيد استلام مبلغ - A4</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
<meta name="robots" content="noindex,nofollow">
<style>
:root{--gold:#C6A14A;--black:#0b0f19;--ink:#111827;--muted:#6b7280;--paper:#fff;--stamp:#0a4ea6;--green:#16a34a}
body{margin:0;background:#f6f7f9;color:var(--ink);font-family:"Cairo",system-ui}
.wrap{max-width:1280px;margin:auto;padding:12px;display:grid;gap:12px;grid-template-columns:clamp(320px,40vw,520px) 1fr}
@media(max-width:1024px){.wrap{grid-template-columns:1fr}}
.card{background:#fff;border:1px solid #e7e9ef;border-radius:14px;box-shadow:0 8px 16px rgba(0,0,0,.05);overflow:hidden}
.hd{padding:14px;background:linear-gradient(90deg,var(--black),#1b2335);color:#fff;font-weight:800;text-align:center}
.bd{padding:14px}
label{display:block;font:700 13px/1 "Cairo";color:var(--muted);margin:8px 2px 6px}
input,select,textarea{width:100%;padding:12px;border:1px solid #dfe3ea;border-radius:12px;font-size:15px;background:#fff}
textarea{min-height:100px;resize:vertical}
.btn{border:0;border-radius:12px;padding:12px 14px;font-weight:800;font-size:15px;cursor:pointer}
.btn.primary{background:var(--gold);color:#000}.btn.ghost{background:#eef2f7}
.tool{display:inline-flex;align-items:center;gap:8px;height:42px;padding:0 14px;border-radius:12px;border:1px solid #e4e7ef;background:#fff;cursor:pointer;font-weight:800;font-size:13.5px}
.tool.dark{background:linear-gradient(180deg,#1b2335,#0b0f19);color:#fff;border:0}
.preview{padding:8px 10px 0}
.viewport{width:100%;display:flex;justify-content:center;align-items:flex-start;overflow:hidden}
.scale-box{transform-origin:top center;display:inline-block}
#page{width:210mm;height:297mm;background:var(--paper);position:relative;overflow:hidden;border:1px solid #e6e7ec;border-radius:14px;box-shadow:0 10px 26px rgba(0,0,0,.06)}
/* رأس الإيصال */
.lh{background:linear-gradient(90deg,var(--black),#121828);color:#fff;padding:12px 18px;display:flex;align-items:center;gap:10px;justify-content:space-between}
.brand-block{display:flex;align-items:center;gap:10px}
.brand-name{font-weight:800;font-size:20px}
.receipt-meta{text-align:left;direction:ltr;font-size:12px;line-height:1.5}
.gold-line{height:5px;background:linear-gradient(90deg,#ead89c,var(--gold),#a6842a)}
.doc{padding:12mm 18mm 64mm;height:calc(297mm - 53px - 5px - 64mm);overflow:auto}
.title{text-align:center;font-size:22px;font-weight:800;margin:12px 0 10px}
.meta{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.box{border:1px solid #e9ecf3;border-radius:12px;padding:10px;background:#fff}
.kv{font-size:14px;line-height:1.8}
.kv .row{display:flex;gap:6px}
.kv .row b{min-width:100px;color:#374151}
.badge{font-size:12px;color:#fff;background:var(--green);border-radius:999px;padding:2px 8px}
.note{margin-top:10px;border:1px dashed #e5e7eb;border-radius:12px;padding:10px;background:#fafafa;color:#374151}
.sig-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px}
.sig{border:1px dashed #cbd5e1;border-radius:10px;padding:8px;height:90px;display:flex;justify-content:center;align-items:end;font-size:13px;color:#374151}
.ft{position:absolute;left:0;right:0;bottom:0;height:64mm;padding:10mm 18mm 14mm;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px}
.stamp-box{min-width:70mm;min-height:33mm;padding:10px 12px;border-radius:12px;position:relative;border:2px solid var(--stamp);background:#fff;text-align:center}
.stamp-ink{color:var(--stamp);font-weight:800;font-size:16px}
.stamp-line{color:var(--stamp);font-weight:700;margin-top:4px}
.qr{position:absolute;top:10mm;left:18mm;width:84px;height:84px;border:1px dashed #cbd5e1;border-radius:10px;display:grid;place-items:center}
@page{size:A4;margin:0}
@media print{body *{visibility:hidden}#page,#page *{visibility:visible}#page{position:absolute;inset:0;transform:none;box-shadow:none}}
</style>
</head>
<body>
<main class="wrap">
  <section class="card">
    <div class="hd">إعدادات الإيصال</div>
    <div class="bd">
      <label>اسم المؤسسة</label><input id="sellerName">
      <label>الهاتف</label><input id="sellerPhone">
      <label>البريد</label><input id="sellerEmail">
      <label>العنوان</label><input id="sellerAddr">
      <label>السجل التجاري CR</label><input id="cr">
      <label>اسم الدافع</label><input id="buyerName">
      <label>رقم الإيصال</label><input id="rcpNo">
      <label>تاريخ الإيصال</label><input id="rcpDate" type="date">
      <label>المبلغ</label><input id="amountNum" type="number" step="0.001">
      <label>طريقة الدفع</label><select id="payMethod"><option>نقدًا</option><option>تحويل بنكي</option><option>بطاقة</option><option>شيك</option></select>
      <label>مرجع الدفع</label><input id="payRef">
    </div>
  </section>
  <section class="card">
    <div class="hd">معاينة</div>
    <div class="preview"><div class="viewport" id="viewport"><div class="scale-box" id="scaleBox">
      <div id="page">
        <header class="lh">
          <div class="brand-block">
            <div class="brand-name" id="brandName">اسم المؤسسة</div>
          </div>
          <div class="receipt-meta">
            <div><b>Receipt No:</b> <span id="outNo">—</span></div>
            <div><b>Date:</b> <span id="outDate">—</span></div>
          </div>
        </header>
        <div class="gold-line"></div>
        <main class="doc">
          <h1 class="title">إيصال استلام مبلغ</h1>
          <div class="kv"><div class="row"><b>الدافع:</b><span id="buyerBlock">—</span></div></div>
          <div class="kv"><div class="row"><b>المبلغ:</b><span id="outAmountNum">0.000</span> <span class="badge" id="currencyBadge">BHD</span></div></div>
          <div class="kv"><div class="row"><b>كتابةً:</b><span id="outAmountWords">—</span></div></div>
          <div class="sig-row">
            <div class="sig">توقيع المستلم</div>
            <div class="sig">توقيع الدافع</div>
          </div>
        </main>
        <footer class="ft">
          <div class="stamp-box">
            <div class="stamp-ink" id="stampCompany">اسم المؤسسة</div>
            <div class="stamp-line" id="stampPhone">Tel: —</div>
            <div class="stamp-line" id="stampCR">CR: —</div>
          </div>
        </footer>
      </div>
    </div></div>
  </section>
</main>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
<script>
const DM={'٠':'0','١':'1','٢':'2','٣':'3','٤':'4','٥':'5','٦':'6','٧':'7','٨':'8','٩':'9','۰':'0','۱':'1','۲':'2','۳':'3','۴':'4','۵':'5','۶':'6','۷':'7','۸':'8','۹':'9'};
const $=id=>document.getElementById(id);
const NF=n=>new Intl.NumberFormat('en-US',{minimumFractionDigits:3,maximumFractionDigits:3}).format(n);
function numToWordsAr(num,dec=0){
  const ones=["","واحد","اثنان","ثلاثة","أربعة","خمسة","ستة","سبعة","ثمانية","تسعة"];
  const tens=["","عشرة","عشرون","ثلاثون","أربعون","خمسون","ستون","سبعون","ثمانون","تسعون"];
  if(num===0) return "صفر";
  let words="";
  if(num>=1000){words+=ones[Math.floor(num/1000)]+" آلاف ";num%=1000;}
  if(num>=100){words+=ones[Math.floor(num/100)]+" مائة ";num%=100;}
  if(num>=20){words+=ones[Math.floor(num/10)]+" "+tens[Math.floor(num/10)];num%=10;}
  else if(num>=10){words+="";}
  if(num>0) words+=ones[num];
  return words.trim();
}
function apply(){
  const name=$('sellerName').value; const phone=$('sellerPhone').value; const cr=$('cr').value;
  $('brandName').textContent=name||'—';
  $('outNo').textContent=$('rcpNo').value||'—';
  $('outDate').textContent=$('rcpDate').value||new Date().toLocaleDateString('en-GB');
  const amt=parseFloat(($('amountNum').value||'').replace(/[٠-٩۰-۹]/g,d=>DM[d]))||0;
  $('outAmountNum').textContent=NF(amt);
  $('outAmountWords').textContent=numToWordsAr(Math.floor(amt));
  $('buyerBlock').textContent=$('buyerName').value||'—';
  $('stampCompany').textContent=name||'—';
  $('stampPhone').textContent='Tel: '+(phone||'—');
  $('stampCR').textContent='CR: '+(cr||'—');
}
['input','change'].forEach(ev=>{document.querySelectorAll('input,textarea,select').forEach(el=>{el.addEventListener(ev,apply,{passive:true})})});
(document.fonts?.ready||Promise.resolve()).then(()=>{apply()});
</script>
</body>
</html>
