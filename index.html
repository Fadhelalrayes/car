<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Letterhead A4</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --gold:#C6A14A; --gold-soft:#ead89c; --black:#0b0f19; --ink:#111827; --muted:#6b7280; --paper:#fff; --stamp-ink:#111827;
  }
  *{box-sizing:border-box; -webkit-print-color-adjust:exact; print-color-adjust:exact}
  html,body{height:100%}
  body{margin:0; background:#fff; color:var(--ink); font-family:"Cairo",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}

  .wrap{max-width:1100px; margin:auto; padding:16px; display:grid; gap:16px; grid-template-columns:330px 1fr}
  @media (max-width:980px){ .wrap{grid-template-columns:1fr} }
  .card{background:#fff; border:1px solid #e5e7eb; border-radius:14px; box-shadow:0 10px 26px rgba(0,0,0,.06); overflow:hidden}
  .hd{padding:12px 14px; background:linear-gradient(90deg,var(--black),#1b2335); color:#fff; font-weight:800; display:flex; align-items:center; justify-content:space-between}
  .bd{padding:14px}
  label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px}
  input,select,textarea{width:100%; padding:10px 12px; border:1px solid #e5e7eb; border-radius:10px; font-size:14px; background:#fff}
  textarea{min-height:140px; resize:vertical}
  .grid{display:grid; gap:10px}
  .g2{grid-template-columns:1fr 1fr} .g4{grid-template-columns:1fr 1fr 1fr 1fr}
  @media (max-width:640px){ .g2,.g4{grid-template-columns:1fr} }
  .row{display:flex; gap:8px; flex-wrap:wrap}
  .btn{border:0; border-radius:999px; padding:10px 16px; font-weight:700; cursor:pointer}
  .btn.primary{background:var(--gold); color:#000; box-shadow:0 8px 18px rgba(198,161,74,.25)}
  .btn.dark{background:var(--black); color:#fff}
  .btn.ghost{background:#f3f4f6}

  /* ØµÙØ­Ø© A4 */
  #page{
    width:210mm; height:297mm; margin:auto; background:var(--paper); color:var(--ink);
    border:1px solid #e5e7eb; border-radius:16px; box-shadow:0 18px 48px rgba(0,0,0,.07);
    position:relative; overflow:hidden;
  }

  /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
  .lh{background:linear-gradient(90deg,var(--black),#121828); color:#fff; padding:14px 18px; display:flex; align-items:center; justify-content:space-between}
  .brand{display:flex; align-items:center; gap:10px; min-width:0}
  .logo{width:36px; height:36px; border-radius:9px; background:linear-gradient(135deg,var(--gold),var(--gold-soft)); color:#000; display:grid; place-items:center; font-weight:900}
  .brand-name{font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:260px}
  .gold-line{
    height:6px; background:linear-gradient(90deg,var(--gold-soft),var(--gold),#a6842a);
    display:flex; align-items:center; justify-content:flex-end; gap:10px; padding:0 12mm;
  }
  .social-top{display:flex; gap:10px; align-items:center}
  .social-top .ico{display:flex; align-items:center; gap:6px; background:rgba(255,255,255,.9); border:1px solid #e5e7eb; border-radius:999px; padding:2px 6px; font-size:11px}
  .social-top svg{width:12px; height:12px}

  /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
  .doc{
    padding:12mm 18mm 34mm;
    height:calc(297mm - 56px - 6px - 34mm);
    overflow:auto;
  }
  .meta{font-size:12px; color:var(--muted); display:flex; justify-content:space-between; border-bottom:1px dashed #e5e7eb; padding-bottom:6px}
  .title{margin:10px auto 6px; text-align:center; font-size:26px; font-weight:800}
  .content{font-size:15px; line-height:1.9; text-align:justify; text-justify:inter-word}

  /* ØªØ°ÙŠÙŠÙ„ Ø«Ø§Ø¨Øª */
  .ft{
    position:absolute; left:0; right:0; bottom:0;
    height:34mm; padding:6mm 18mm 10mm;
    display:flex; align-items:flex-end; justify-content:space-between; gap:10px; border-top:1px solid #e5e7eb;
  }
  .stamp-block{display:flex; flex-direction:column; gap:6px; align-items:flex-start}
  .stamp-box{
    width:45mm; min-height:20mm; padding:8px 10px; border-radius:9px;
    border:2.2px solid var(--stamp-ink); color:var(--stamp-ink);
    background:radial-gradient(circle at 30% 30%, rgba(0,0,0,.03), transparent 45%),
               repeating-linear-gradient(0deg, rgba(0,0,0,.02), rgba(0,0,0,.02) 2px, transparent 2px, transparent 4px);
    box-shadow:inset 0 0 0 1.2px rgba(255,255,255,.65), 0 6px 16px rgba(0,0,0,.05);
    transform:rotate(-1.3deg); opacity:.94; filter:saturate(1.04) contrast(1.02);
  }
  .stamp-name{font-weight:800; font-size:13px}
  .stamp-line{font-size:11px; direction:ltr; text-align:left}
  .site-under{font-size:11px; color:#374151}
  .site-under strong{font-weight:800}
  .contact-line{display:flex; gap:12px; flex-wrap:wrap; direction:ltr; color:#111; align-items:center}

  /* Ø·Ø¨Ø§Ø¹Ø© ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© */
  @page{ size:A4; margin:0 }
  @media print{
    body *{ visibility:hidden }
    #page, #page *{ visibility:visible }
    #page{ position:absolute; left:0; top:0; width:210mm !important; height:297mm !important; border:none; border-radius:0; box-shadow:none; overflow:hidden !important }
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
    <section class="card" id="formCard">
      <div class="hd">
        <span id="panelTitle">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø·Ø§Ø¨</span>
        <div style="display:flex; gap:8px; align-items:center">
          <label style="color:#e5e7eb; font-size:12px;">Language / Ø§Ù„Ù„ØºØ©</label>
          <select id="langSelect" style="padding:6px 10px; border-radius:8px;">
            <option value="ar" selected>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
            <option value="en">English</option>
          </select>
        </div>
      </div>
      <div class="bd">
        <div class="grid">
          <div><label id="l_company">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label><input id="company" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„Ø£ÙÙ‚ Ù„Ù„ØªØ¬Ø§Ø±Ø©" /></div>

          <div class="g2">
            <div>
              <label id="l_country">Ø§Ù„Ø¯ÙˆÙ„Ø© (ÙƒÙˆØ¯)</label>
              <select id="countryCode">
                <!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© -->
                <option value="+213">ğŸ‡©ğŸ‡¿ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± (+213)</option>
                <option value="+973">ğŸ‡§ğŸ‡­ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† (+973)</option>
                <option value="+269">ğŸ‡°ğŸ‡² Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø± (+269)</option>
                <option value="+253">ğŸ‡©ğŸ‡¯ Ø¬ÙŠØ¨ÙˆØªÙŠ (+253)</option>
                <option value="+20">ğŸ‡ªğŸ‡¬ Ù…ØµØ± (+20)</option>
                <option value="+964">ğŸ‡®ğŸ‡¶ Ø§Ù„Ø¹Ø±Ø§Ù‚ (+964)</option>
                <option value="+962">ğŸ‡¯ğŸ‡´ Ø§Ù„Ø£Ø±Ø¯Ù† (+962)</option>
                <option value="+965">ğŸ‡°ğŸ‡¼ Ø§Ù„ÙƒÙˆÙŠØª (+965)</option>
                <option value="+961">ğŸ‡±ğŸ‡§ Ù„Ø¨Ù†Ø§Ù† (+961)</option>
                <option value="+218">ğŸ‡±ğŸ‡¾ Ù„ÙŠØ¨ÙŠØ§ (+218)</option>
                <option value="+222">ğŸ‡²ğŸ‡· Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§ (+222)</option>
                <option value="+212">ğŸ‡²ğŸ‡¦ Ø§Ù„Ù…ØºØ±Ø¨ (+212)</option>
                <option value="+968">ğŸ‡´ğŸ‡² Ø¹ÙÙ…Ø§Ù† (+968)</option>
                <option value="+970">ğŸ‡µğŸ‡¸ ÙÙ„Ø³Ø·ÙŠÙ† (+970)</option>
                <option value="+974">ğŸ‡¶ğŸ‡¦ Ù‚Ø·Ø± (+974)</option>
                <option value="+966">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© (+966)</option>
                <option value="+252">ğŸ‡¸ğŸ‡´ Ø§Ù„ØµÙˆÙ…Ø§Ù„ (+252)</option>
                <option value="+249">ğŸ‡¸ğŸ‡© Ø§Ù„Ø³ÙˆØ¯Ø§Ù† (+249)</option>
                <option value="+963">ğŸ‡¸ğŸ‡¾ Ø³ÙˆØ±ÙŠØ§ (+963)</option>
                <option value="+216">ğŸ‡¹ğŸ‡³ ØªÙˆÙ†Ø³ (+216)</option>
                <option value="+971">ğŸ‡¦ğŸ‡ª Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª (+971)</option>
                <option value="+967">ğŸ‡¾ğŸ‡ª Ø§Ù„ÙŠÙ…Ù† (+967)</option>
              </select>
            </div>
            <div><label id="l_phone">Ø±Ù‚Ù… Ø§Ù„Ø§ØªØµØ§Ù„</label><input id="phone" type="tel" placeholder="3333 3333" /></div>
          </div>

          <div class="g2">
            <div><label id="l_email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input id="email" type="email" placeholder="name@example.com" /></div>
            <div><label id="l_title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
              <div style="display:flex; gap:6px">
                <input id="title" type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©" />
                <select id="templateSelect" title="Ù‚ÙˆØ§Ù„Ø¨" style="min-width:140px">
                  <option value="none" selected>â€” Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨ â€”</option>
                  <option value="formal">Ø±Ø³Ù…ÙŠ</option>
                  <option value="quote">Ø¹Ø±Ø¶ Ø³Ø¹Ø±</option>
                  <option value="auth">ØªÙÙˆÙŠØ¶</option>
                  <option value="complaint">Ø´ÙƒÙˆÙ‰</option>
                  <option value="thanks">Ø´ÙƒØ± ÙˆØªÙ‚Ø¯ÙŠØ±</option>
                </select>
              </div>
            </div>
          </div>

          <div><label id="l_content">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label><textarea id="content" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§..."></textarea></div>

          <div class="g4">
            <div><label>Instagram</label><input id="ig" type="text" placeholder="@brand" /></div>
            <div><label>Twitter / X</label><input id="tw" type="text" placeholder="@brand" /></div>
            <div><label>Facebook</label><input id="fb" type="text" placeholder="/brand" /></div>
            <div><label>LinkedIn</label><input id="ln" type="text" placeholder="/company/brand" /></div>
          </div>

          <div class="g2">
            <div><label id="l_stampname">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (Ù„Ù„Ø®ØªÙ…)</label><input id="stampName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©" /></div>
            <div><label id="l_cr">Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ (CR)</label><input id="cr" type="text" placeholder="555432" /></div>
          </div>
          <div class="g2">
            <div><label id="l_stampphone">Ø±Ù‚Ù… Ø§Ù„Ø§ØªØµØ§Ù„ (Ù„Ù„Ø®ØªÙ…)</label><input id="stampPhone" type="tel" placeholder="3333 3333" /></div>
            <div><label id="l_sitename">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø£Ø³ÙÙ„ Ø§Ù„Ø®ØªÙ…)</label><input id="siteName" type="text" placeholder="example.com" /></div>
          </div>
          <div><label id="l_sitetag">ØµÙØ©/ÙˆØµÙ Ù‚ØµÙŠØ± Ù„Ù„Ù…ÙˆÙ‚Ø¹</label><input id="siteTag" type="text" placeholder="Ø®Ø¯Ù…Ø§Øª ÙˆØ­Ù„ÙˆÙ„ Ù…ØªÙƒØ§Ù…Ù„Ø©" /></div>

          <div class="row">
            <button class="btn primary" id="applyBtn" type="button">ØªØ·Ø¨ÙŠÙ‚</button>
            <button class="btn dark" id="printBtn" type="button">Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
            <button class="btn ghost" id="resetBtn" type="button">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© / Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹ -->
    <section class="card">
      <div class="bd">
        <div class="page" id="page">
          <header class="lh">
            <div class="brand">
              <div class="logo">â˜…</div>
              <div class="brand-name" id="brandName">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</div>
            </div>
            <div></div>
          </header>
          <div class="gold-line"><div class="social-top" id="socialTop"></div></div>

          <main class="doc">
            <div class="meta">
              <div id="metaDateLbl">Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="today"></span></div>
              <div id="metaRefLbl">Ù…Ø±Ø¬Ø¹: <span id="ref">â€”</span></div>
            </div>
            <h1 class="title" id="titleOut">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©</h1>
            <article class="content" id="contentOut">Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ØŒ ÙˆØ³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø£Ø·Ø±Ø§Ù.</article>
          </main>

          <footer class="ft">
            <div class="stamp-block">
              <div class="stamp-box">
                <div class="stamp-name" id="stampNameOut">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</div>
                <div class="stamp-line" id="crOut">CR: â€”</div>
                <div class="stamp-line" id="stampPhoneOut">Tel: â€”</div>
              </div>
              <div class="site-under" id="siteUnder"><strong>example.com</strong> â€” Ø®Ø¯Ù…Ø§Øª ÙˆØ­Ù„ÙˆÙ„ Ù…ØªÙƒØ§Ù…Ù„Ø©</div>
            </div>
            <div class="contact-line">
              <span id="emailOut">name@example.com</span>
              <span>â€¢</span>
              <span id="phoneOut">+973 0000 0000</span>
            </div>
          </footer>
        </div>
      </div>
    </section>
  </div>

<script>
  // Ø¹Ù†Ø§ØµØ±
  const company = document.getElementById('company');
  const email = document.getElementById('email');
  const phone = document.getElementById('phone');
  const countryCode = document.getElementById('countryCode');
  const titleIn = document.getElementById('title');
  const contentIn = document.getElementById('content');
  const ig = document.getElementById('ig');
  const tw = document.getElementById('tw');
  const fb = document.getElementById('fb');
  const ln = document.getElementById('ln');
  const stampName = document.getElementById('stampName');
  const cr = document.getElementById('cr');
  const stampPhone = document.getElementById('stampPhone');
  const siteName = document.getElementById('siteName');
  const siteTag = document.getElementById('siteTag');
  const langSelect = document.getElementById('langSelect');
  const templateSelect = document.getElementById('templateSelect');

  const brandName = document.getElementById('brandName');
  const emailOut = document.getElementById('emailOut');
  const phoneOut = document.getElementById('phoneOut');
  const titleOut = document.getElementById('titleOut');
  const contentOut = document.getElementById('contentOut');
  const stampNameOut = document.getElementById('stampNameOut');
  const crOut = document.getElementById('crOut');
  const stampPhoneOut = document.getElementById('stampPhoneOut');
  const siteUnder = document.getElementById('siteUnder');
  const socialTop = document.getElementById('socialTop');
  const todayEl = document.getElementById('today');
  const metaDateLbl = document.getElementById('metaDateLbl');
  const metaRefLbl = document.getElementById('metaRefLbl');

  // ØªØ±Ø¬Ù…Ø©
  const T = {
    ar: {
      panelTitle:'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø·Ø§Ø¨', company:'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©', country:'Ø§Ù„Ø¯ÙˆÙ„Ø© (ÙƒÙˆØ¯)', phone:'Ø±Ù‚Ù… Ø§Ù„Ø§ØªØµØ§Ù„',
      email:'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', title:'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©', content:'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©',
      stampname:'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (Ù„Ù„Ø®ØªÙ…)', cr:'Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ (CR)', stampphone:'Ø±Ù‚Ù… Ø§Ù„Ø§ØªØµØ§Ù„ (Ù„Ù„Ø®ØªÙ…)',
      sitename:'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø£Ø³ÙÙ„ Ø§Ù„Ø®ØªÙ…)', sitetag:'ØµÙØ©/ÙˆØµÙ Ù‚ØµÙŠØ± Ù„Ù„Ù…ÙˆÙ‚Ø¹',
      placeholders:{ company:'Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„Ø£ÙÙ‚ Ù„Ù„ØªØ¬Ø§Ø±Ø©', title:'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©', content:'Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§...' },
      metaDate:'Ø§Ù„ØªØ§Ø±ÙŠØ®', metaRefPrefix:'Ù…Ø±Ø¬Ø¹: ',
      templates:{
        formal:{title:'Ø®Ø·Ø§Ø¨ Ø±Ø³Ù…ÙŠ', body:`Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡ØŒ\n\nÙ†ØªÙ‚Ø¯Ù… Ø¥Ù„ÙŠÙƒÙ… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø®Ø·Ø§Ø¨ Ø¨Ø´Ø£Ù† ...... Ø±Ø§Ø¬ÙŠÙ† ØªØ¹Ø§ÙˆÙ†ÙƒÙ… Ø§Ù„ÙƒØ±ÙŠÙ…ØŒ\nÙˆÙŠØ³Ø±Ù‘Ù†Ø§ ØªØ²ÙˆÙŠØ¯ÙƒÙ… Ø¨Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.\n\nÙˆØªÙØ¶Ù„ÙˆØ§ Ø¨Ù‚Ø¨ÙˆÙ„ ÙØ§Ø¦Ù‚ Ø§Ù„Ø§Ø­ØªØ±Ø§Ù….`},
        quote:{title:'Ø¹Ø±Ø¶ Ø³Ø¹Ø±', body:`Ø§Ù„Ø³Ø§Ø¯Ø© Ø§Ù„Ù…Ø­ØªØ±Ù…ÙˆÙ†ØŒ\n\nÙ†ÙÙŠØ¯ÙƒÙ… Ø¨Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªØ§Ù„ÙŠ:\n- Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø£ÙˆÙ„: ......\n- Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ: ......\n- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ......\n\nØ§Ù„Ø¹Ø±Ø¶ Ø³Ø§Ø±ÙŠ Ù„Ù…Ø¯Ø© 7 Ø£ÙŠØ§Ù… Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®Ø·Ø§Ø¨.`},
        auth:{title:'ØªÙÙˆÙŠØ¶', body:`Ø£ÙÙˆÙ‘Ø¶ Ø£Ù†Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ø¯Ù†Ø§Ù‡ ...... Ø¨Ø­Ø¶ÙˆØ±/Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ù€ ...... Ù„Ø¯Ù‰ Ø¬Ù‡Ø§ØªÙƒÙ… Ø§Ù„Ù…ÙˆÙ‚Ø±Ø©ØŒ\nÙˆØ°Ù„Ùƒ Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø© Ù…Ù† ... Ø¥Ù„Ù‰ ...ØŒ ÙˆØ¬Ù…ÙŠØ¹ Ù…Ø§ ÙŠÙ‚ÙˆÙ… Ø¨Ù‡ ÙŠØ¹ØªØ¨Ø± Ù†Ø§ÙØ°Ù‹Ø§ Ø¹Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙŠ.`},
        complaint:{title:'Ø®Ø·Ø§Ø¨ Ø´ÙƒÙˆÙ‰', body:`Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®ØªØµØ©ØŒ\n\nØ£ØªÙ‚Ø¯Ù… Ø¥Ù„ÙŠÙƒÙ… Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø¨Ø®ØµÙˆØµ ......ØŒ ÙˆÙ†Ø£Ù…Ù„ Ù…Ù† Ø³ÙŠØ§Ø¯ØªÙƒÙ… Ø§ØªØ®Ø§Ø° Ø§Ù„Ù„Ø§Ø²Ù… ÙˆÙÙ‚ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…ØªØ¨Ø¹Ø©.\n\nØ´Ø§ÙƒØ±ÙŠÙ† ØªØ¹Ø§ÙˆÙ†ÙƒÙ….`},
        thanks:{title:'Ø´ÙƒØ± ÙˆØªÙ‚Ø¯ÙŠØ±', body:`Ù†ÙˆØ¯ Ø£Ù† Ù†ØªÙ‚Ø¯Ù… Ø¨Ø®Ø§Ù„Øµ Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ø¥Ù„Ù‰ ...... Ø¹Ù„Ù‰ Ø¬Ù‡ÙˆØ¯Ù‡ ÙˆØªØ¹Ø§ÙˆÙ†Ù‡ Ø§Ù„Ù…Ø«Ù…Ø±ØŒ Ù…ØªÙ…Ù†ÙŠÙ† Ù„Ù‡ Ø¯ÙˆØ§Ù… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­.`}
      }
    },
    en: {
      panelTitle:'Letterhead Settings', company:'Company Name', country:'Country Code', phone:'Phone Number',
      email:'Email', title:'Subject', content:'Letter Content',
      stampname:'Company (Stamp)', cr:'Commercial Reg. (CR)', stampphone:'Phone (Stamp)',
      sitename:'Website (under stamp)', sitetag:'Website tagline/role',
      placeholders:{ company:'e.g., Horizon Trading Co.', title:'Subject', content:'Write your letter here...' },
      metaDate:'Date', metaRefPrefix:'Ref: ',
      templates:{
        formal:{title:'Formal Letter', body:`Dear Sir/Madam,\n\nWe would like to address the matter of ...... and appreciate your kind cooperation.\nPlease let us know if you require any additional information.\n\nSincerely,`},
        quote:{title:'Quotation', body:`Dear Client,\n\nPlease find our quotation:\n- Item 1: ......\n- Item 2: ......\n- Total: ......\n\nThis offer is valid for 7 days from the letter date.`},
        auth:{title:'Authorization', body:`I, the undersigned, hereby authorize ...... to handle the procedures related to ...... with your esteemed entity from ... to ... . All actions taken are under my responsibility.`},
        complaint:{title:'Complaint', body:`To whom it may concern,\n\nThis is to file a complaint regarding ...... Kindly take the necessary actions as per applicable regulations.\n\nThank you.`},
        thanks:{title:'Appreciation', body:`We would like to express our sincere thanks and appreciation to ...... for the great efforts and fruitful cooperation. Wishing continued success.`}
      }
    }
  };

  // Ø®Ø±Ø§Ø¦Ø· Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©/Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
  const labels = {
    l_company:'company', l_country:'country', l_phone:'phone', l_email:'email', l_title:'title',
    l_content:'content', l_stampname:'stampname', l_cr:'cr', l_stampphone:'stampphone',
    l_sitename:'sitename', l_sitetag:'sitetag'
  };

  // ØªØ­ÙˆÙŠÙ„ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©/ÙØ§Ø±Ø³ÙŠ Ø¥Ù„Ù‰ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
  const digitMap = {'Ù ':'0','Ù¡':'1','Ù¢':'2','Ù£':'3','Ù¤':'4','Ù¥':'5','Ù¦':'6','Ù§':'7','Ù¨':'8','Ù©':'9','Û°':'0','Û±':'1','Û²':'2','Û³':'3','Û´':'4','Ûµ':'5','Û¶':'6','Û·':'7','Û¸':'8','Û¹':'9'};
  function normalizeDigits(str){ return (str||'').replace(/[Ù -Ù©Û°-Û¹]/g, d => digitMap[d] || d); }

  function formatDateEN(){
    const d = new Date();
    return d.toLocaleDateString('en-GB'); // dd/mm/yyyy
  }

  function applyLanguage(){
    const lang = langSelect.value;
    const pack = T[lang];
    document.getElementById('panelTitle').textContent = pack.panelTitle;
    Object.entries(labels).forEach(([id,key])=>{ const el=document.getElementById(id); if(el) el.textContent = pack[key]; });
    company.placeholder = pack.placeholders.company;
    titleIn.placeholder = pack.placeholders.title;
    contentIn.placeholder = pack.placeholders.content;
    document.documentElement.lang = lang;
    document.documentElement.dir  = (lang==='ar') ? 'rtl' : 'ltr';
    // ØªØ­Ø¯ÙŠØ« Ù…Ø³Ù…ÙŠØ§Øª Ø§Ù„Ù…ÙŠØªØ§
    document.getElementById('metaDateLbl').innerHTML = `${pack.metaDate}: <span id="today">${formatDateEN()}</span>`;
    document.getElementById('metaRefLbl').childNodes[0].nodeValue = pack.metaRefPrefix;
  }

  // Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
  const icons = {
    ig:'<svg viewBox="0 0 24 24" fill="#E1306C"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm5 5a5 5 0 1 0 .001 10.001A5 5 0 0 0 12 7Zm6.5-.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z"/><circle cx="12" cy="12" r="3.3"/></svg>',
    tw:'<svg viewBox="0 0 24 24" fill="#000"><path d="M13.7 10.6 21 2h-1.7l-6.2 7.4L8.2 2H2l7.6 11L2 22h1.7l6.6-7.8L15.8 22H22l-8.3-11.4Z"/></svg>',
    fb:'<svg viewBox="0 0 24 24" fill="#1877F2"><path d="M22 12a10 10 0 1 0-11.6 9.9v-7H7.7V12h2.7V9.7c0-2.7 1.6-4.2 4-4.2 1.2 0 2.4.2 2.4.2v2.6h-1.4c-1.3 0-1.7.8-1.7 1.6V12h2.9l-.46 2.9h-2.4v7A10 10 0 0 0 22 12"/></svg>',
    ln:'<svg viewBox="0 0 24 24" fill="#0A66C2"><path d="M4.98 3.5a2.5 2.5 0 1 1 0 5.001 2.5 2.5 0 0 1 0-5zM3 9h4v12H3zM9 9h3.8v1.6h.1c.5-.9 1.8-1.9 3.7-1.9 4 0 4.8 2.6 4.8 6v6H17v-5.3c0-1.3 0-3-1.9-3s-2.2 1.4-2.2 2.9V21H9z"/></svg>'
  };

  function buildSocialTop(){
    socialTop.innerHTML = '';
    [{val:ig.value.trim(),key:'ig'},{val:tw.value.trim(),key:'tw'},{val:fb.value.trim(),key:'fb'},{val:ln.value.trim(),key:'ln'}]
      .forEach(x=>{
        if(!x.val) return;
        const el=document.createElement('span'); el.className='ico';
        el.innerHTML = icons[x.key] + '<span>'+ x.val + '</span>';
        socialTop.appendChild(el);
      });
  }

  function fullPhone(){
    const cc = normalizeDigits(countryCode.value || '');
    const p  = normalizeDigits(phone.value || '');
    return (cc && p) ? `${cc} ${p}` : (p || '');
  }

  function insertTemplate(){
    const lang = langSelect.value;
    const val = templateSelect.value;
    if(val==='none') return;
    const pack = T[lang].templates[val];
    titleIn.value = pack.title;
    contentIn.value = pack.body;
  }

  function applyChanges(){
    // ÙˆØ§Ø¬Ù‡Ø© ÙˆÙ„ØºØ©
    applyLanguage();

    // Ù…Ø®Ø±Ø¬Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
    const lang = langSelect.value;
    brandName.textContent = company.value || (lang==='ar' ? 'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©' : 'Company');
    emailOut.textContent = email.value || 'name@example.com';
    phoneOut.textContent = fullPhone() || '+973 0000 0000';

    titleOut.textContent = titleIn.value || (lang==='ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©' : 'Subject');
    contentOut.textContent = normalizeDigits(contentIn.value || (lang==='ar' ? 'â€”' : 'â€”'));

    // Ø§Ù„Ø®ØªÙ…
    stampNameOut.textContent = stampName.value || brandName.textContent;
    crOut.textContent = 'CR: ' + (normalizeDigits(cr.value) || 'â€”');
    stampPhoneOut.textContent = 'Tel: ' + (normalizeDigits(stampPhone.value) || (fullPhone() || 'â€”'));

    // Ø£Ø³ÙÙ„ Ø§Ù„Ø®ØªÙ…
    const sName = siteName.value.trim() || 'example.com';
    const sTag  = siteTag.value.trim();
    siteUnder.innerHTML = `<strong>${sName}</strong>${sTag ? ' â€” ' + sTag : ''}`;

    // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
    todayEl.textContent = formatDateEN();

    // Ø³ÙˆØ´ÙŠØ§Ù„
    buildSocialTop();
  }

  // Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
  [phone,countryCode,cr,stampPhone,contentIn,titleIn,siteTag].forEach(el=>{
    el.addEventListener('input', ()=>{ el.value = normalizeDigits(el.value); });
  });

  // Ø£Ø­Ø¯Ø§Ø«
  [company,email,phone,countryCode,titleIn,contentIn,ig,tw,fb,ln,stampName,cr,stampPhone,siteName,siteTag,langSelect]
    .forEach(el=> el.addEventListener('input', applyChanges));
  templateSelect.addEventListener('change', ()=>{ insertTemplate(); applyChanges(); });

  // Ø·Ø¨Ø§Ø¹Ø© ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©
  const triggerPrint = ()=>{ applyChanges(); requestAnimationFrame(()=> setTimeout(()=>window.print(), 40)); };
  document.getElementById('applyBtn').addEventListener('click', applyChanges);
  document.getElementById('printBtn').addEventListener('click', triggerPrint);
  document.getElementById('resetBtn').addEventListener('click', ()=>{
    document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"]').forEach(i=>i.value='');
    [ig,tw,fb,ln,siteName,siteTag,contentIn,titleIn].forEach(i=> i.value='');
    langSelect.value='ar'; templateSelect.value='none'; applyChanges();
  });

  // ØªÙ‡ÙŠØ¦Ø©
  (document.fonts?.ready || Promise.resolve()).then(()=>{ applyLanguage(); todayEl.textContent = formatDateEN(); applyChanges(); });
</script>
</body>
</html>
