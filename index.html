<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مولّد صفحة خطاب رسمي (Letterhead)</title>
  <style>
    :root {
      --brand: #0f766e; /* لون الهيدر الافتراضي */
      --ink: #0f172a;   /* لون النص */
      --muted: #64748b; /* نص ثانوي */
      --paper: #ffffff; /* خلفية الورقة */
      --page-bg: #f1f5f9; /* خلفية الصفحة */
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: "Cairo", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans";
      color: var(--ink); background: var(--page-bg);
    }

    .container {
      max-width: 1100px; margin: 24px auto; padding: 16px; display: grid; gap: 16px;
      grid-template-columns: 360px 1fr;
    }

    /* اللوحة */
    .panel {
      background: #fff; border: 1px solid #e2e8f0; border-radius: 16px; box-shadow: 0 10px 20px rgba(2,6,23,0.05);
      padding: 18px; position: sticky; top: 16px; align-self: start;
    }
    .panel h2 { margin: 0 0 12px; font-size: 18px; }
    .field { margin-bottom: 12px; }
    .label { display: block; font-size: 13px; color: var(--muted); margin-bottom: 6px; }
    input[type="text"], input[type="email"], input[type="tel"], input[type="color"], textarea {
      width: 100%; border: 1px solid #cbd5e1; border-radius: 10px; padding: 10px 12px; font-size: 14px; background: #fff;
    }
    textarea { min-height: 180px; resize: vertical; }

    .row { display: grid; gap: 8px; grid-template-columns: 1fr 1fr; }

    .actions { display: flex; gap: 10px; margin-top: 8px; flex-wrap: wrap; }
    button {
      border: 0; border-radius: 999px; padding: 10px 16px; font-weight: 700; cursor: pointer;
      background: var(--brand); color: #fff; box-shadow: 0 8px 16px rgba(15,118,110,.2);
    }
    button.secondary { background: #0ea5e9; box-shadow: 0 8px 16px rgba(14,165,233,.2); }
    button.ghost { background: #e2e8f0; color: #0f172a; box-shadow: none; }

    /* ورقة الخطاب */
    .canvas-wrap { padding: 12px; }
    .page {
      margin: 0 auto; background: var(--paper); color: var(--ink); width: 210mm; min-height: 297mm;
      border: 1px solid #e2e8f0; border-radius: 16px; box-shadow: 0 20px 50px rgba(2,6,23,0.06);
      position: relative; overflow: hidden; display: flex; flex-direction: column;
    }

    .letterhead {
      background: var(--brand); color: #fff; padding: 22px 28px; display: flex; align-items: center; justify-content: space-between;
    }
    .brand {
      display: flex; align-items: center; gap: 12px; font-weight: 900; letter-spacing: .3px; font-size: 20px;
    }
    .brand .logo {
      width: 38px; height: 38px; border-radius: 10px; background: rgba(255,255,255,.2);
      display:flex; align-items:center; justify-content:center; font-weight:900;
    }
    .contact { font-size: 12px; opacity: .95; text-align: left; direction: ltr; }

    .doc { padding: 28px; flex: 1; display: flex; flex-direction: column; gap: 12px; }
    .title { font-size: 26px; text-align: center; margin: 8px 0 4px; font-weight: 800; letter-spacing: .2px; }
    .meta { display: flex; justify-content: space-between; color: var(--muted); font-size: 12px; border-bottom: 1px dashed #e2e8f0; padding-bottom: 10px; }

    .content { font-size: 15px; line-height: 1.9; text-align: justify; text-justify: inter-word; }

    .social {
      margin-top: auto; border-top: 1px dashed #e2e8f0; padding-top: 10px; color: var(--muted); font-size: 12px;
      display: flex; gap: 10px; flex-wrap: wrap;
    }

    .stamp {
      position: absolute; bottom: 28mm; left: 28mm; border: 2.5px solid #0f172a; border-radius: 8px; padding: 10px 12px;
      width: 68mm; min-height: 26mm; display: grid; gap: 4px; background: rgba(15,23,42,0.02);
    }
    .stamp::after {
      content: "ختم"; position: absolute; top: -11px; right: 12px; background: var(--paper); padding: 0 6px; font-size: 12px; color: var(--muted);
    }
    .stamp .s-name { font-weight: 800; font-size: 14px; }
    .stamp .s-line { font-size: 12px; color: #111827; direction: ltr; text-align: left; }

    .footer {
      margin-top: auto; background: #f8fafc; color: #0f172a; border-top: 1px solid #e5e7eb; padding: 10px 14px; font-size: 12px; display: flex; gap: 8px; justify-content: space-between; align-items: center;
    }

    /* حالة المعاينة النهائية */
    .finalized .panel { display: none; }
    .finalized .edit-bar { display: flex; }

    .edit-bar { display: none; gap: 10px; justify-content: center; padding: 0 12px 12px; }

    /* الطباعة إلى PDF */
    @page { size: A4; margin: 12mm; }
    @media print {
      body { background: #fff; }
      .container { display: block; margin: 0; padding: 0; }
      .panel, .edit-bar, .footer { display: none !important; }
      .page { box-shadow: none; border: 0; border-radius: 0; width: auto; min-height: unset; }
      .stamp { left: 18mm; bottom: 20mm; }
    }

    /* تجاوب */
    @media (max-width: 1000px) {
      .container { grid-template-columns: 1fr; }
      .panel { position: static; }
    }
  </style>
</head>
<body>
  <div class="container" id="app">
    <!-- لوحة الإدخال -->
    <section class="panel" id="formPanel" aria-label="لوحة إنشاء الخطاب">
      <h2>إعدادات الخطاب</h2>

      <div class="field">
        <label class="label">اسم الشركة</label>
        <input type="text" id="company" placeholder="مثال: شركة الأفق للتجارة" />
      </div>

      <div class="row">
        <div class="field">
          <label class="label">البريد الإلكتروني</label>
          <input type="email" id="email" placeholder="name@example.com" />
        </div>
        <div class="field">
          <label class="label">رقم الاتصال</label>
          <input type="tel" id="phone" placeholder="+973 0000 0000" />
        </div>
      </div>

      <div class="field">
        <label class="label">أسماء/روابط شبكات التواصل (افصل بينها بفاصلة)</label>
        <input type="text" id="social" placeholder="X: @brand, Instagram: @brand, LinkedIn: /company/brand" />
      </div>

      <div class="row">
        <div class="field">
          <label class="label">عنوان الرسالة (يظهر كبير ومتوسط الصفحة)</label>
          <input type="text" id="title" placeholder="عنوان الرسالة" />
        </div>
        <div class="field">
          <label class="label">اختيار لون الهيدر</label>
          <input type="color" id="brandColor" value="#0f766e" />
        </div>
      </div>

      <div class="field">
        <label class="label">محتوى الرسالة (النص مضبوط المحاذاة)</label>
        <textarea id="content" placeholder="اكتب نص الرسالة هنا... سيتم ضبط المحاذاة تلقائياً على الطرفين."></textarea>
      </div>

      <fieldset style="border:1px dashed #cbd5e1; padding:10px 12px; border-radius:12px;">
        <legend style="font-size:13px; color:var(--muted);">بيانات الختم (مستطيل)</legend>
        <div class="field">
          <label class="label">اسم الشركة (للختم)</label>
          <input type="text" id="stampName" placeholder="اسم الشركة" />
        </div>
        <div class="row">
          <div class="field">
            <label class="label">رقم السجل التجاري</label>
            <input type="text" id="cr" placeholder="CR / السجل التجاري" />
          </div>
          <div class="field">
            <label class="label">رقم الاتصال (للختم)</label>
            <input type="tel" id="stampPhone" placeholder="رقم الاتصال" />
          </div>
        </div>
      </fieldset>

      <div class="actions">
        <button id="completeBtn">إكمال</button>
        <button class="secondary" id="previewBtn" type="button">معاينة مباشرة</button>
        <button class="ghost" id="clearBtn" type="button">إعادة ضبط</button>
      </div>
    </section>

    <!-- المعاينة / الناتج -->
    <section class="canvas-wrap">
      <div class="edit-bar" id="editBar">
        <button class="ghost" id="backBtn" type="button">تعديل</button>
        <button class="secondary" id="printBtn" type="button">تحميل PDF / طباعة</button>
      </div>

      <div class="page" id="page">
        <!-- رأس احترافي -->
        <header class="letterhead" id="letterhead">
          <div class="brand">
            <div class="logo" id="logoBox">ﻟﻬ</div>
            <div id="brandName">اسم الشركة</div>
          </div>
          <div class="contact" id="brandContact">
            <div><span id="emailOut" dir="ltr">name@example.com</span></div>
            <div><span id="phoneOut" dir="ltr">+973 0000 0000</span></div>
          </div>
        </header>

        <!-- محتوى الخطاب -->
        <main class="doc">
          <div class="meta">
            <div>التاريخ: <span id="today"></span></div>
            <div>مرجع: <span id="ref">—</span></div>
          </div>

          <h1 class="title" id="titleOut">عنوان الرسالة</h1>

          <article class="content" id="contentOut">
            اكتب نص الرسالة من اللوحة اليمنى، وسوف يظهر هنا بمحاذاة الأطراف (Justify).
          </article>

          <div class="social" id="socialOut"></div>

          <!-- الختم -->
          <div class="stamp" id="stampBox">
            <div class="s-name" id="stampNameOut">اسم الشركة</div>
            <div class="s-line" id="crOut">CR: —</div>
            <div class="s-line" id="stampPhoneOut">Tel: —</div>
          </div>
        </main>

        <footer class="footer">
          <div>تم الإنشاء بواسطة مولّد الخطابات — HTML/CSS/JS</div>
          <div style="direction:ltr;">© <span id="year"></span></div>
        </footer>
      </div>
    </section>
  </div>

  <script>
    // عناصر
    const root = document.documentElement;
    const company = document.getElementById('company');
    const email = document.getElementById('email');
    const phone = document.getElementById('phone');
    const social = document.getElementById('social');
    const titleIn = document.getElementById('title');
    const brandColor = document.getElementById('brandColor');
    const contentIn = document.getElementById('content');

    const stampName = document.getElementById('stampName');
    const cr = document.getElementById('cr');
    const stampPhone = document.getElementById('stampPhone');

    const brandName = document.getElementById('brandName');
    const emailOut = document.getElementById('emailOut');
    const phoneOut = document.getElementById('phoneOut');
    const titleOut = document.getElementById('titleOut');
    const contentOut = document.getElementById('contentOut');
    const socialOut = document.getElementById('socialOut');

    const stampNameOut = document.getElementById('stampNameOut');
    const crOut = document.getElementById('crOut');
    const stampPhoneOut = document.getElementById('stampPhoneOut');

    const completeBtn = document.getElementById('completeBtn');
    const previewBtn = document.getElementById('previewBtn');
    const clearBtn = document.getElementById('clearBtn');
    const backBtn = document.getElementById('backBtn');
    const printBtn = document.getElementById('printBtn');

    const app = document.getElementById('app');

    // التاريخ والسنة
    const today = new Date();
    document.getElementById('today').textContent = today.toLocaleDateString('ar-EG');
    document.getElementById('year').textContent = today.getFullYear();

    // وظائف مساعدة
    function setBrandColor(hex) {
      root.style.setProperty('--brand', hex);
    }

    function splitSocial(val) {
      return val.split(',').map(s => s.trim()).filter(Boolean);
    }

    function updatePreview() {
      brandName.textContent = company.value || 'اسم الشركة';
      emailOut.textContent = email.value || 'name@example.com';
      phoneOut.textContent = phone.value || '+973 0000 0000';
      titleOut.textContent = titleIn.value || 'عنوان الرسالة';
      contentOut.textContent = contentIn.value || '—';

      // شبكات التواصل
      socialOut.innerHTML = '';
      const items = splitSocial(social.value);
      if (items.length) {
        items.forEach((txt) => {
          const badge = document.createElement('span');
          badge.textContent = txt;
          badge.style.border = '1px solid #cbd5e1';
          badge.style.padding = '4px 8px';
          badge.style.borderRadius = '999px';
          badge.style.background = '#fff';
          socialOut.appendChild(badge);
        });
      }

      // الختم
      stampNameOut.textContent = stampName.value || (company.value || 'اسم الشركة');
      crOut.textContent = 'CR: ' + (cr.value || '—');
      stampPhoneOut.textContent = 'Tel: ' + (stampPhone.value || (phone.value || '—'));
    }

    function toggleFinalize(state) {
      if (state) {
        app.classList.add('finalized');
      } else {
        app.classList.remove('finalized');
      }
    }

    // أحداث إدخال حي
    [company, email, phone, social, titleIn, brandColor, contentIn, stampName, cr, stampPhone].forEach(el => {
      el.addEventListener('input', () => {
        if (el === brandColor) setBrandColor(el.value);
        updatePreview();
      });
    });

    // أزرار
    document.getElementById('previewBtn').addEventListener('click', () => { updatePreview(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
    completeBtn.addEventListener('click', () => { updatePreview(); toggleFinalize(true); });
    backBtn.addEventListener('click', () => toggleFinalize(false));
    printBtn.addEventListener('click', () => window.print());
    clearBtn.addEventListener('click', () => {
      document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"]').forEach(i => i.value = '');
      contentIn.value = '';
      brandColor.value = '#0f766e';
      setBrandColor('#0f766e');
      updatePreview();
    });

    // تهيئة أولية
    setBrandColor(brandColor.value);
    updatePreview();
  </script>
</body>
</html>
