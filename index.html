<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>حاسبة الخمس الشرعي — وفق فتاوى السيد السيستاني</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f5f6f8; --ink:#111827; --muted:#6b7280;
    --card:#ffffff; --line:#e5e7eb;
    --gold:#b58900; --gold-soft:#f5d574;
    --emerald:#059669; --crimson:#dc2626;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:"Cairo",sans-serif; background:var(--bg); color:var(--ink)}
  header{text-align:center; padding:24px 12px}
  .brand{font-family:"Amiri",serif; font-size:clamp(28px,4.5vw,42px); color:var(--gold)}
  .tag{margin-top:6px; font-size:14px; color:var(--muted)}
  .shell{max-width:900px; margin:0 auto; padding:0 16px}
  .hero{background:var(--card); border:1px solid var(--line); border-radius:20px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,.05)}
  .row{display:grid; gap:16px}
  @media(min-width:860px){ .row{grid-template-columns:1fr 1fr} }
  .field{display:flex; flex-direction:column; gap:8px; margin-bottom:12px}
  .field label{font-weight:700;}
  .field input[type="number"]{
    width:100%; padding:12px; border:1px solid var(--line); border-radius:10px; text-align:center; font-family:monospace; font-size: 16px;
  }
  .btn{padding:12px 20px; border-radius:10px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--gold),var(--gold-soft)); color:#111; font-weight:700; display:block; margin:16px auto 0; width: 100%;}
  
  /* نتائج الحساب */
  .results{background:#f9fafb; border:1px solid var(--line); border-radius:16px; padding:16px; text-align:center; margin-top:10px;}
  .results h4{margin:0 0 10px; font-family:"Amiri",serif; color:var(--gold); font-size: 20px;}
  .results .value{font-weight:800; font-size:28px; color:var(--emerald); font-family:monospace;}
  .results .label{font-size:14px; color:#374151; margin-top:4px;}

  .deck{display:grid; gap:12px; grid-template-columns:1fr; margin-top:20px}
  @media(min-width:860px){ .deck{grid-template-columns:repeat(2,1fr)} }
  .card{background:#fdfdfd; border:1px solid var(--line); border-radius:12px; padding:16px; box-shadow:0 2px 6px rgba(0,0,0,.04)}
  .card h3{margin:0 0 8px; font-family:"Amiri",serif; color:var(--gold)}
  .card p, .card ul{margin:0; font-size:14px; color:#374151; line-height:1.7}
  .card ul{margin-top:8px; padding-inline-start:20px;}
  .card .cite { font-size: 10px; color: var(--muted); display: inline-block; margin-right: 4px; }

  footer{text-align:center; margin:20px 0 16px; font-size:12px; color:#6b7280}
  .ghost-link{color:inherit; text-decoration:none; cursor:pointer}
  .ghost-link:visited{color:inherit}

  /* Toast */
  .toast{
    position:fixed; left:50%; bottom:24px; transform:translateX(-50%) translateY(20px);
    background:#ffffff; color:#111827; border:1px solid var(--line); box-shadow:0 8px 24px rgba(0,0,0,.12);
    border-radius:14px; padding:12px 14px; min-width:260px; max-width:92vw; z-index:9999; opacity:0; transition:.25s ease;
  }
  .toast.show{opacity:1; transform:translateX(-50%) translateY(0)}
  .toast .title{font-weight:700; color:var(--gold); margin-bottom:4px; font-family:"Amiri",serif}
</style>
</head>
<body>
<header>
  <div class="brand">حاسبة الخمس</div>
  <div class="tag">أدخل المبلغ الفائض عن مؤونة السنة لحساب مقدار الخمس الواجب.</div>
</header>

<main class="shell">
  <section class="hero">
    <div class="row">
      <div>
        <div class="field">
          <label for="amount">المبلغ الفائض عن مؤونة السنة</label>
          <input id="amount" type="number" inputmode="decimal" placeholder="أدخل المبلغ هنا" autocomplete="off"/>
        </div>
        <button class="btn" id="calc">احسب الخمس</button>
      </div>

      <div>
        <div id="resultBox" class="results" style="display:none;">
          <h4>مقدار الخمس الواجب</h4>
          <div id="khumsValue" class="value">0</div>
          <div class="label">وهو ما يعادل 20% من المبلغ الفائض</div>
        </div>
      </div>
    </div>
  </section>

  <section id="info" class="deck">
    <div class="card">
      <h3>تعريف الخمس</h3>
      <p>الخمس حقّ مالي مقرّر في الشريعة الإسلاميّة المقدّسة بنصّ القرآن الكريم، ويجب إخراج خُمس (20%) من أنواع معيّنة من المال. وأبرزها بالنسبة لعموم الناس هو &quot;أرباح المكاسب&quot;، أي كل فائدة أو ربح يحصل عليه الإنسان من تجارة، أو وظيفة، أو عمل حر، أو هبة، ويزيد عن حاجته وحاجة عائلته (المؤونة) خلال سنة كاملة.</p>
    </div>
    <div class="card">
      <h3>أحكام الخمس (أرباح المكاسب)</h3>
      <ul>
        <li>يجب الخمس في الأرباح والفوائد بعد استثناء مصاريف تحصيلها ومصاريف المعيشة للشخص وعائلته خلال العام (المؤونة).</li>
        <li>رأس السنة الخمسية لمن له مهنة يتعاطاها في معاشه (كالتجّار والموظّفين) هو أوّل زمان الشروع في الاكتساب.</li>
        <li>رأس السنة الخمسية لمن يعيش على الهبات والعطايا هو أوّل زمان حصولها.</li>
        <li>المال الذي يتم تجميعه لشراء بيت أو سيارة أو لأجل الزواج، يجب فيه الخمس إذا حال عليه الحول (مرت عليه السنة الخمسية) ولم يُصرف في مؤونته.</li>
        <li>لا يجب الخمس في المهر، وعوض الخلع، وديات الأعضاء، وما يملك بالإرث (عدا بعض الاستثناءات).</li>
      </ul>
    </div>
    <div class="card">
      <h3>مسائل في الخمس</h3>
      <p><strong>خمس مال الصبي والمجنون:</strong> لا يشترط في ثبوت الخمس كون المالك بالغاً عاقلاً، فيثبت الخمس في أموال الصبيّ والمجنون. ويجب على الوليّ إخراجه منها، وإن لم يخرجه الوليّ وجب عليهما إخراجه بعد البلوغ والإفاقة.</p>
      <p style="margin-top: 8px;"><strong>التهاون في الأداء:</strong> من يتهاون في أداء الخمس لسنوات، عليه أن يجرّد ممتلكاته ويراجع الحاكم الشرعي أو وكيله لتصفية حسابه والمصالحة في المقدار المشكوك فيه وتقسيط ما لا يتيسّر له دفعه مرّة واحدة.</p>
    </div>
    <div class="card">
      <h3>سن التكليف</h3>
      <p>سن التكليف هو السن الذي يصبح فيه المسلم مكلفاً بأداء الواجبات الشرعية كالصلاة والصوم والخمس. ويتحقق البلوغ الشرعي بظهور إحدى علاماته، وأهمها:</p>
      <ul>
        <li><strong>للذكر:</strong> إكمال خمس عشرة سنة قمرية.</li>
        <li><strong>للأنثى:</strong> إكمال تسع سنين قمرية.</li>
      </ul>
      <p style="margin-top: 8px;">ويجب الخمس في أرباح المكاسب بعد حلول رأس السنة الخمسية، سواء كان المالك بالغاً أو صبياً (كما ذكرنا في المسائل).</p>
    </div>
  </section>

  <footer>
    <a class="ghost-link" href="https://www.sistani.org/arabic/book/24/1861/" target="_blank" rel="noopener">المصدر: الأحكام مبنية على فتاوى مكتب السيد السيستاني (دام ظله)</a>
  </footer>
</main>

<!-- Toast -->
<div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true" style="display:none">
  <div class="title">تنبيه</div>
  <div class="msg">—</div>
</div>

<script>
/* عناصر */
const amountEl = document.getElementById('amount');
const calcBtn = document.getElementById('calc');
const resultBox = document.getElementById('resultBox');
const khumsValue = document.getElementById('khumsValue');
const toast = document.getElementById('toast');
const toastMsg = toast.querySelector('.msg');

/* فلترة أرقام فقط */
amountEl.addEventListener('input', () => {
  // السماح بالأرقام والنقطة العشرية فقط
  amountEl.value = amountEl.value.replace(/[^0-9.]/g, '');
});

/* Toast */
let toastTimer = null;
function showToast(message, opts = { type: 'info', title: 'تنبيه', timeout: 2800 }) {
  toast.style.display = 'block';
  toast.classList.remove('error');
  if (opts.type === 'error') toast.classList.add('error');
  toast.querySelector('.title').textContent = opts.title || 'تنبيه';
  toastMsg.textContent = message;
  requestAnimationFrame(() => toast.classList.add('show'));
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => { toast.classList.remove('show'); }, opts.timeout || 2800);
}

/* الحساب */
calcBtn.addEventListener('click', () => {
  const amount = parseFloat(amountEl.value);

  if (isNaN(amount) || amount < 0) {
    showToast('الرجاء إدخال مبلغ صحيح.', { type: 'error', title: 'خطأ في الإدخال' });
    resultBox.style.display = 'none';
    return;
  }

  const khums = amount * 0.20;
  
  // استخدام toLocaleString لتنسيق الأرقام مع فواصل
  khumsValue.textContent = khums.toLocaleString('ar-EG', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  resultBox.style.display = 'block';
});
</script>
</body>
</html>
