<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مولّد خطاب احترافي</title>

  <!-- خطوط عربية جميلة -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Noto+Kufi+Arabic:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#0f766e;          /* لون الهيدر */
      --ink:#0f172a;            /* لون النص */
      --muted:#6b7280;          /* نص ثانوي */
      --paper:#fff;             /* خلفية الورقة */
      --bg:#f5f7fb;             /* خلفية الموقع */
      --stamp-ink:#0b5cff;      /* حبر الختم الافتراضي (أزرق) */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Cairo","Noto Kufi Arabic",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:var(--ink);
      line-height:1.6;
    }

    /* تخطيط عام */
    .wrap{
      max-width:1200px; margin-inline:auto; padding:16px;
      display:grid; gap:16px;
      grid-template-columns: 1fr 2fr;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr}
    }

    /* بطاقة */
    .card{
      background:#fff; border:1px solid #e5e7eb; border-radius:16px;
      box-shadow:0 12px 30px rgba(2,6,23,.06);
    }
    .card .hd{
      padding:14px 16px; border-bottom:1px solid #eef2f7; display:flex; align-items:center; gap:10px;
      font-weight:800; letter-spacing:.2px;
    }
    .card .bd{ padding:16px }

    /* نموذج مبسّط */
    .grid{ display:grid; gap:10px }
    .g2{ grid-template-columns:1fr 1fr }
    @media (max-width:640px){ .g2{grid-template-columns:1fr} }

    label{ font-size:13px; color:var(--muted); margin-bottom:6px; display:block }
    input[type="text"],input[type="email"],input[type="tel"],input[type="color"],textarea,select{
      width:100%; padding:10px 12px; border:1px solid #d7dde6; border-radius:10px; background:#fff; font-size:14px
    }
    textarea{ min-height:140px; resize:vertical }

    .row{ display:flex; gap:8px; flex-wrap:wrap }
    .btn{
      border:0; border-radius:999px; padding:10px 16px; font-weight:700; cursor:pointer
    }
    .btn.primary{ background:var(--brand); color:#fff; box-shadow:0 10px 20px rgba(15,118,110,.22) }
    .btn.ghost{ background:#eef2f7 }
    .btn.alt{ background:#0ea5e9; color:#fff }

    /* صفحة A4 */
    .page-wrap{ padding:8px }
    .page{
      width:210mm; min-height:297mm; margin-inline:auto; background:var(--paper); color:var(--ink);
      border:1px solid #e5e7eb; border-radius:16px; overflow:hidden; position:relative;
      box-shadow:0 24px 60px rgba(2,6,23,.08);
    }
    /* على الشاشات الصغيرة تمتد بعرض الشاشة */
    @media (max-width: 820px){
      .page{ width:100%; min-height:auto }
    }

    /* الهيدر (Letterhead) */
    .lh{
      background:var(--brand); color:#fff; padding:20px 22px; display:flex; align-items:center; justify-content:space-between;
      print-color-adjust: exact; -webkit-print-color-adjust: exact;
    }
    .brand{ display:flex; align-items:center; gap:12px; font-weight:800 }
    .logo{
      width:40px; height:40px; border-radius:10px; background:rgba(255,255,255,.22);
      display:grid; place-items:center; font-weight:800
    }
    .contact{ font-size:12px; text-align:left; direction:ltr; opacity:.95 }

    /* جسم الخطاب */
    .doc{ padding:22px; display:flex; flex-direction:column; gap:12px }
    .meta{
      font-size:12px; color:var(--muted); display:flex; justify-content:space-between; gap:10px;
      border-bottom:1px dashed #e5e7eb; padding-bottom:8px
    }
    .title{
      margin:6px auto 2px; text-align:center; font-size:26px; font-weight:800; letter-spacing:.2px
    }
    .content{ font-size:15px; text-align:justify; text-justify:inter-word }

    .social{ margin-top:auto; border-top:1px dashed #e5e7eb; padding-top:10px; display:flex; gap:8px; flex-wrap:wrap; color:var(--muted); font-size:12px }
    .badge{ border:1px solid #d7dde6; padding:4px 8px; border-radius:999px; background:#fff }

    /* ختم واقعي */
    .stamp-area{ margin-top:18px; display:flex; gap:12px; align-items:flex-start; flex-wrap:wrap }
    .stamp-box{
      position:relative; width:70mm; min-height:28mm; padding:10px 12px; border-radius:10px;
      border:2.5px solid var(--stamp-ink); color:var(--stamp-ink);
      background:
        radial-gradient(circle at 30% 30%, rgba(0,0,0,.03), transparent 45%),
        repeating-linear-gradient(0deg, rgba(0,0,0,.02), rgba(0,0,0,.02) 2px, transparent 2px, transparent 4px);
      box-shadow:
        inset 0 0 0 1.5px rgba(255,255,255,.65),
        0 6px 18px rgba(0,0,0,.06);
      transform: rotate(-1.2deg);
      opacity:.92;
      filter: saturate(1.1) contrast(1.02);
    }
    .stamp-box::before{
      content:"ختم"; position:absolute; top:-11px; right:10px; background:var(--paper);
      color:#6b7280; padding:0 6px; font-size:12px
    }
    .stamp-name{ font-weight:800; font-size:14px }
    .stamp-line{ font-size:12px; direction:ltr; text-align:left }

    /* تذييل */
    .ft{ background:#fafbfe; border-top:1px solid #eef2f7; padding:10px 14px; font-size:12px; display:flex; justify-content:space-between }

    /* شريط المعاينة */
    .toolbar{ display:flex; gap:8px; justify-content:center; padding:10px }

    /* طباعة */
    @page{ size:A4; margin:12mm }
    @media print{
      body{ background:#fff }
      .wrap{ display:block; padding:0; margin:0 }
      .card{ display:none !important }
      .toolbar{ display:none !important }
      .page{ border:none; border-radius:0; box-shadow:none }
      .lh{ print-color-adjust: exact; -webkit-print-color-adjust: exact }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- النموذج -->
    <section class="card" id="formCard" aria-label="إعدادات الخطاب">
      <div class="hd">إعدادات الخطاب</div>
      <div class="bd">
        <div class="grid">
          <div>
            <label>اسم الشركة</label>
            <input id="company" type="text" placeholder="مثال: شركة الأفق للتجارة" />
          </div>
          <div class="grid g2">
            <div>
              <label>البريد الإلكتروني</label>
              <input id="email" type="email" placeholder="name@example.com" />
            </div>
            <div>
              <label>رقم الاتصال</label>
              <input id="phone" type="tel" placeholder="+973 0000 0000" />
            </div>
          </div>

          <div>
            <label>شبكات التواصل (افصل بفاصلة)</label>
            <input id="social" type="text" placeholder="X: @brand, Instagram: @brand, LinkedIn: /company/brand" />
          </div>

          <div class="grid g2">
            <div>
              <label>عنوان الرسالة (يتوسط الصفحة)</label>
              <input id="title" type="text" placeholder="عنوان الرسالة" />
            </div>
            <div>
              <label>لون الهيدر</label>
              <input id="brandColor" type="color" value="#0f766e" />
            </div>
          </div>

          <div>
            <label>محتوى الرسالة (محاذاة الأطراف)</label>
            <textarea id="content" placeholder="اكتب نص الرسالة هنا..."></textarea>
          </div>

          <hr style="border:none; border-top:1px dashed #e5e7eb; margin:6px 0">

          <!-- خانة الختم -->
          <div class="grid g2">
            <div>
              <label>اسم الشركة (للختم)</label>
              <input id="stampName" type="text" placeholder="اسم الشركة" />
            </div>
            <div>
              <label>رقم السجل التجاري</label>
              <input id="cr" type="text" placeholder="CR / السجل التجاري" />
            </div>
          </div>
          <div class="grid g2">
            <div>
              <label>رقم الاتصال (للختم)</label>
              <input id="stampPhone" type="tel" placeholder="رقم الاتصال" />
            </div>
            <div>
              <label>لون حبر الختم</label>
              <select id="stampInk">
                <option value="#0b5cff">أزرق</option>
                <option value="#e11d48">أحمر</option>
                <option value="#111827">أسود</option>
              </select>
            </div>
          </div>
          <div>
            <label>رفع صورة ختم (اختياري)</label>
            <input id="stampImage" type="file" accept="image/*" />
            <small style="color:var(--muted)">إن رفعت صورة، سنستخدمها بدل الختم المولد.</small>
          </div>

          <div class="row">
            <button class="btn primary" id="applyBtn" type="button">تطبيق التغييرات</button>
            <button class="btn alt" id="finalBtn" type="button">إكمال / معاينة نهائية</button>
            <button class="btn ghost" id="printBtn" type="button">طباعة / حفظ PDF</button>
            <button class="btn ghost" id="resetBtn" type="button">إعادة ضبط</button>
          </div>
        </div>
      </div>
    </section>

    <!-- المعاينة -->
    <section class="card">
      <div class="hd">المعاينة</div>
      <div class="bd page-wrap">
        <div class="page" id="page">
          <!-- الهيدر -->
          <header class="lh" id="lh">
            <div class="brand">
              <div class="logo" id="logo">LH</div>
              <div id="brandName">اسم الشركة</div>
            </div>
            <div class="contact">
              <div id="emailOut">name@example.com</div>
              <div id="phoneOut">+973 0000 0000</div>
            </div>
          </header>

          <!-- الجسم -->
          <main class="doc">
            <div class="meta">
              <div>التاريخ: <span id="today"></span></div>
              <div>مرجع: <span id="ref">—</span></div>
            </div>

            <h1 class="title" id="titleOut">عنوان الرسالة</h1>

            <article class="content" id="contentOut">اكتب نص الرسالة من الحقول ثم اضغط «تطبيق التغييرات». ستظهر الرسالة هنا بمحاذاة الأطراف.</article>

            <div class="social" id="socialOut"></div>

            <div class="stamp-area">
              <!-- ختم مولّد -->
              <div class="stamp-box" id="stampBox">
                <div class="stamp-name" id="stampNameOut">اسم الشركة</div>
                <div class="stamp-line" id="crOut">CR: —</div>
                <div class="stamp-line" id="stampPhoneOut">Tel: —</div>
              </div>
              <!-- صورة ختم -->
              <img id="stampImgOut" alt="صورة الختم" style="display:none; width:70mm; height:auto; border-radius:10px; transform:rotate(-1.2deg); filter:contrast(1.05) saturate(1.05) drop-shadow(0 6px 18px rgba(0,0,0,.06));" />
            </div>
          </main>

          <footer class="ft">
            <div>Letterhead — تصميم مبسّط وأنيق</div>
            <div style="direction:ltr;">© <span id="year"></span></div>
          </footer>
        </div>

        <div class="toolbar" id="toolbar" style="display:none">
          <button class="btn ghost" id="backBtn" type="button">تعديل</button>
          <button class="btn alt" id="printBtn2" type="button">طباعة / PDF</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    // عناصر الإدخال
    const company = document.getElementById('company');
    const email = document.getElementById('email');
    const phone = document.getElementById('phone');
    const social = document.getElementById('social');
    const titleIn = document.getElementById('title');
    const brandColor = document.getElementById('brandColor');
    const contentIn = document.getElementById('content');

    const stampName = document.getElementById('stampName');
    const cr = document.getElementById('cr');
    const stampPhone = document.getElementById('stampPhone');
    const stampInk = document.getElementById('stampInk');
    const stampImage = document.getElementById('stampImage');

    // عناصر الإخراج
    const brandName = document.getElementById('brandName');
    const emailOut = document.getElementById('emailOut');
    const phoneOut = document.getElementById('phoneOut');
    const titleOut = document.getElementById('titleOut');
    const contentOut = document.getElementById('contentOut');
    const socialOut = document.getElementById('socialOut');

    const stampBox = document.getElementById('stampBox');
    const stampNameOut = document.getElementById('stampNameOut');
    const crOut = document.getElementById('crOut');
    const stampPhoneOut = document.getElementById('stampPhoneOut');
    const stampImgOut = document.getElementById('stampImgOut');

    const lh = document.getElementById('lh');
    const page = document.getElementById('page');
    const formCard = document.getElementById('formCard');
    const toolbar = document.getElementById('toolbar');

    const applyBtn = document.getElementById('applyBtn');
    const finalBtn = document.getElementById('finalBtn');
    const printBtn = document.getElementById('printBtn');
    const printBtn2 = document.getElementById('printBtn2');
    const backBtn = document.getElementById('backBtn');
    const resetBtn = document.getElementById('resetBtn');

    // تاريخ/سنة
    const today = new Date();
    document.getElementById('today').textContent = today.toLocaleDateString('ar-EG');
    document.getElementById('year').textContent = today.getFullYear();

    // وظائف
    const setBrand = (hex)=>{ document.documentElement.style.setProperty('--brand', hex) }
    const setStampInk = (hex)=>{ document.documentElement.style.setProperty('--stamp-ink', hex) }
    const parseSocial = (val)=> val.split(',').map(s=>s.trim()).filter(Boolean);

    function applyChanges(){
      // هيدر
      brandName.textContent = company.value || 'اسم الشركة';
      emailOut.textContent = email.value || 'name@example.com';
      phoneOut.textContent = phone.value || '+973 0000 0000';
      setBrand(brandColor.value || '#0f766e');

      // عنوان ومحتوى
      titleOut.textContent = titleIn.value || 'عنوان الرسالة';
      contentOut.textContent = contentIn.value || '—';

      // تواصل اجتماعي
      socialOut.innerHTML = '';
      parseSocial(social.value).forEach(txt=>{
        const b = document.createElement('span');
        b.className = 'badge';
        b.textContent = txt;
        socialOut.appendChild(b);
      });

      // ختم مولّد
      stampNameOut.textContent = stampName.value || (company.value || 'اسم الشركة');
      crOut.textContent = 'CR: ' + (cr.value || '—');
      stampPhoneOut.textContent = 'Tel: ' + (stampPhone.value || (phone.value || '—'));
      setStampInk(stampInk.value);

      // صورة ختم (إن وُجدت)
      if(stampImage.files && stampImage.files[0]){
        const reader = new FileReader();
        reader.onload = (e)=>{
          stampImgOut.src = e.target.result;
          stampImgOut.style.display = 'block';
          stampBox.style.display = 'none';
        };
        reader.readAsDataURL(stampImage.files[0]);
      }else{
        stampImgOut.style.display = 'none';
        stampBox.style.display = 'block';
      }
    }

    function finalizeView(state){
      if(state){
        formCard.style.display = 'none';
        toolbar.style.display = 'flex';
        window.scrollTo({top:0, behavior:'smooth'});
      }else{
        formCard.style.display = '';
        toolbar.style.display = 'none';
      }
    }

    // أحداث
    applyBtn.addEventListener('click', applyChanges);
    finalBtn.addEventListener('click', ()=>{ applyChanges(); finalizeView(true); });
    backBtn.addEventListener('click', ()=> finalizeView(false));
    printBtn.addEventListener('click', ()=>{ applyChanges(); window.print(); });
    printBtn2.addEventListener('click', ()=>{ applyChanges(); window.print(); });

    resetBtn.addEventListener('click', ()=>{
      document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"]').forEach(i=>i.value='');
      contentIn.value = ''; brandColor.value='#0f766e'; stampInk.value='#0b5cff'; stampImage.value='';
      setBrand('#0f766e'); setStampInk('#0b5cff');
      applyChanges();
    });

    // تحديث مباشر عند إدخال بسيط (تحسين تجربة)
    [company,email,phone,social,titleIn,brandColor,contentIn,stampName,cr,stampPhone,stampInk].forEach(el=>{
      el.addEventListener('input', applyChanges);
    });

    // تهيئة
    applyChanges();
  </script>
</body>
</html>
